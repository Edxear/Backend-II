<div class="box">
    <div class="header">
        <div class="user-info">
            {{#if user}}
                <h2>Bienvenido, {{user.first_name}} {{user.last_name}}!</h2>
                <p>Email: {{user.email}}</p>
                <p>Rol: {{user.role}}</p>
                <form id="logoutForm" style="display: inline;">
                    <button type="submit" id="button-logout" class="button">Logout</button>
                </form>
            {{/if}}
        </div>
        <div class="view-cart"><a id="button-cart" class="button" href="/cart/1">Ver Carrito</a></div>
    </div>
    <h1>Productos</h1>
    <div class="products-box">
        {{#each products}}
            <div class="product-card">
                <h3>{{this.title}}</h3>
                <hr>
                <p>Categoria: {{this.category}}</p>
                <p>Descripci√≥n: {{this.description}}</p>
                <p>Precio: $ {{this.price}}</p>
                <button id="button-create" onclick="addToCart('{{this._id}}')">Agregar al Carrito</button>
            </div>
        {{/each}}
    </div>
    <div class="footer">
        {{#if prevLink.exist}}
            <a id="button-paginate" class="button" href="{{prevLink.link}}">Anterior</a>
        {{/if}}
        {{#if nextLink.exist}}
            <a id="button-paginate" class="button" href="{{nextLink.link}}">Siguiente</a>
        {{/if}}
    </div>
</div>

<script>
    document.getElementById('logoutForm').addEventListener('submit', async (e) => {
        e.preventDefault();

        try {
            const response = await fetch('/api/sessions/logout', {
                method: 'POST'
            });

            if (response.ok) {
                window.location.href = '/login';
            }
        } catch (error) {
            console.error('Error:', error);
        }
    });
</script>
<script src="/js/ecommerce.js"></script>